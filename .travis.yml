branches:
  only:
    - master
    - develop_controller_refactor
sudo: required
dist: trusty
language: python
python:
  - 3.4
jdk:
  - openjdk7
before_script:
  - sudo apt-get update -qq
  - sudo bash ./deploy/provision.sh
  - export PYTHONPATH=$(pwd)
  - python3.4 $WORKSPACE/stress_test/controller_test_basic.py $WORKSPACE/stress_test/controller_test.json $WORKSPACE/controllers/odl_beryllium_pb/
  - deactivate
  - cd ..
  - cd util/unittests
script:
  - echo "Running Unittests"
  - coverage erase
  - coverage run --omit='/usr/local/lib/python3.4/*' --include='../*.py' --parallel-mode test_stats.py
  - coverage run --omit='/usr/local/lib/python3.4/*' --include='../*.py' --parallel-mode test_cpu.py
  - coverage run --omit='/usr/local/lib/python3.4/*' --include='../*.py' --parallel-mode test_customsubprocess.py
  - coverage run --omit='/usr/local/lib/python3.4/*' --include='../*.py' --parallel-mode test_numeric.py
  - coverage run --omit='/usr/local/lib/python3.4/*' --include='../*.py' --parallel-mode test_file.py
  - coverage run --omit='/usr/local/lib/python3.4/*' --include='../*.py' --parallel-mode test_sysstats.py
  - coverage run --omit='/usr/local/lib/python3.4/*' --include='../*.py' --parallel-mode test_html.py
  #- coverage run --omit='/usr/local/lib/python3.4/*' --include='../*.py' --parallel-mode test_process.py
  - coverage run --omit='/usr/local/lib/python3.4/*' --include='../*.py' --parallel-mode test_netutil.py
  - coverage run --omit='/usr/local/lib/python3.4/*' --include='../*.py' --parallel-mode ../../stress_test/nstat_orchestrator.py --help
  - coverage combine
after_success:
  coveralls
notifications:
  email: false
